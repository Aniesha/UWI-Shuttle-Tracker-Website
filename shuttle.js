
(function(){

	var path = [[10.649879, -61.395859], [10.649578, -61.395998], [10.648521, -61.395976],
				[10.648647, -61.397124], [10.645631, -61.397714], [10.646728, -61.401190],
				[10.645431, -61.401458], [10.644792, -61.401506], [10.643329, -61.401578],
				[10.642975, -61.402408], [10.638170, -61.400303], [10.638050, -61.399727],
				[10.638468, -61.399636], [10.638736, -61.398938]];


	var path2 = [[10.638508,-61.399004],[10.638423,-61.399391],[10.638002,-61.399734],[10.637959,-61.400378],
				[10.639689,-61.401064],[10.641755,-61.401837],[10.642957,-61.402341],[10.643189,-61.40159],
				[10.644096,-61.401547],[10.645298,-61.401461],[10.645383,-61.401912],[10.645467,-61.40292],
				[10.645657,-61.403908],[10.646753,-61.404423],[10.647238,-61.40498],[10.64785,-61.405882],
				[10.648166,-61.405689],[10.648324,-61.406198],[10.648546,-61.406799],[10.648672,-61.407217],
				[10.64901,-61.408199],[10.649495,-61.409272],[10.650064,-61.410903],[10.650781,-61.412748],
				[10.651161,-61.413993],[10.651519,-61.415817],[10.651498,-61.417383],[10.65114,-61.418992],
				[10.651076,-61.420451],[10.650697,-61.42176],[10.650338,-61.423177],[10.650106,-61.424421],
				[10.649874,-61.425258],[10.649347,-61.42543],[10.649221,-61.425215],[10.649326,-61.424464],
				[10.649368,-61.424185],[10.649052,-61.424099],[10.648356,-61.424078],[10.647723,-61.423906],
				[10.647512,-61.423455],[10.64785,-61.421889],[10.648061,-61.420966],[10.648272,-61.419915],
				[10.647512,-61.419743],[10.646838,-61.419808],[10.6461,-61.420494],[10.645804,-61.420516],
				[10.645467,-61.420065],[10.645277,-61.420065]];			



	var coords = []; //shuttle1
	var coords2 = [];//shuttle2

	for(var i = 0; i<path.length; i++) 
		coords[i] = { lat : path[i][0], long: path[i][1] };

	for(var j = 0; j<path2.length; j++) 
		coords2[j] = { lat : path2[j][0], long: path2[j][1] };


	/*sendRoute(coords);
	sendRoute(coords2);*/

	//sendCoords(coords);
	


	$("#start1").click(function(){
		sendCoords(coords, 1, path.length);
	});


	$("#start2").click(function(){
		sendCoords(coords2, 2, path2.length);
	});



	
	


	function sendCoords (coords, id, n, x=0, fwd = true) {  //coords and shuttleid        
	   setTimeout(function () {
	   		console.log("iter"+ x);
	   		var json = JSON.stringify(coords[x]);

		 	$.ajax({
				type: 'POST',
				url: 'server.php',
				data: {'shuttlecoords': json, 'shuttleid': id},
				success: function(data) {
					console.log(data);
				}
			});
			
		  (fwd)? x++:x--;	  
		  
		  if (x<n && x>=0) {	
			sendCoords(coords, id, n, x, fwd);	
		  }
		  else{
			x = (fwd)? n-1 : 0;
			fwd = !fwd;
		  	sendCoords(coords, id, n, x, fwd);
		  }                        
	   }, 3000)
	}


	function sendRoute(coords){
		var json = JSON.stringify(coords);
		console.log(json);
		$.ajax({
				type: 'POST',
				url: 'server.php',
				data: {'add_coords': json},
				success: function() {
					console.log("ok");
				}
			});
	}

})();//wrapper